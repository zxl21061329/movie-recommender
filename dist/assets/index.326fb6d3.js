import{d as C}from"./index.f11cc044.js";import{_ as w}from"./index.4f20f1f2.js";import{l,V as z,q as s,t as u,x as o,y as i,C as n,G as m,A as g,P as p,Q as _,X as j,F as B}from"./element-plus.82ea873e.js";const x={components:{Page:w},data(){return{movies:[],tags:[],form:{tag:null,order:"num",page:1,pagesize:16,total:0},orders:{collect:"\u6536\u85CF\u6392\u5E8F",rate:"\u8BC4\u5206\u6392\u5E8F",years:"\u65F6\u95F4\u6392\u5E8F",num:"\u70ED\u5EA6\u6392\u5E8F"}}},async created(){await this.get_tags(),this.form.tag=this.$route.query.tag,this.form.tag&&(this.form.tag=Number(this.form.tag)),await this.search()},computed:{title(){return[(this.tags.find(t=>t.id===this.form.tag)||{}).name,this.orders[this.form.order]].filter(t=>t).join(" - ")}},methods:{methods:{toDetail(a){const t=this.movies.find(h=>h.id===a);t&&this.$router.push({name:"Detail",params:{id:a,tags:t.tags}})}},handleCurrentChange(a){this.form.page=a,this.search()},changeOrder(){this.form.page=1,this.search()},async search(){let{data:{Data:{total:a,results:t}}}=await C.post("movies/",this.form);this.movies=t,this.form.total=a},async get_tags(){let{data:{Data:a}}=await C.get("all_tags/");this.tags=a}}},N={class:"card-header"},P={class:"movies"},q={style:{"text-align":"center","font-size":"12px"}},O={style:{display:"flex","justify-content":"center","margin-top":"30px"}};function F(a,t,h,U,r,c){const f=l("el-option"),v=l("el-select"),b=l("el-button"),y=l("el-card"),V=l("el-pagination"),k=l("Page"),D=z("src");return s(),u(k,null,{default:o(()=>[i(y,null,{header:o(()=>[n("div",N,[n("span",null,m(c.title),1),n("div",null,[i(v,{clearable:"",filterable:"",class:"button",type:"primary",size:"large",onChange:c.changeOrder,modelValue:r.form.tag,"onUpdate:modelValue":t[0]||(t[0]=e=>r.form.tag=e),placeholder:"\u7535\u5F71\u6807\u7B7E"},{default:o(()=>[(s(!0),g(_,null,p(r.tags,e=>(s(),u(f,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"]),i(v,{style:{"margin-left":"10px"},class:"button",type:"primary",size:"large",onChange:c.changeOrder,modelValue:r.form.order,"onUpdate:modelValue":t[1]||(t[1]=e=>r.form.order=e)},{default:o(()=>[(s(!0),g(_,null,p(r.orders,(e,d)=>(s(),u(f,{key:d,label:e,value:d},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"])])])]),default:o(()=>[n("div",P,[(s(!0),g(_,null,p(r.movies,e=>(s(),u(y,{class:"movie",shadow:"hover",key:e.id,onClick:d=>a.toDetail(e.id),style:{cursor:"pointer"}},{default:o(()=>[j(n("img",null,null,512),[[D,e.image_link]]),i(b,{type:"text"},{default:o(()=>[B(m(e.name),1)]),_:2},1024),n("span",q,m(e.years),1)]),_:2},1032,["onClick"]))),128))]),n("div",O,[i(V,{onCurrentChange:c.handleCurrentChange,"current-page":r.form.page,"page-size":r.form.pagesize,layout:"prev, pager, next, jumper, total",total:r.form.total,background:""},null,8,["onCurrentChange","current-page","page-size","total"])])]),_:1})]),_:1})}x.render=F;x.__scopeId="data-v-5cd26d8a";export{x as default};

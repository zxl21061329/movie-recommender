import{d as y}from"./index.483ac227.js";import{_ as D}from"./index.a8dadfd5.js";import{l as n,V as w,q as s,t as c,x as o,y as u,C as l,G as m,A as g,P as p,Q as _,X as z,F as j}from"./element-plus.82ea873e.js";const C={components:{Page:D},data(){return{movies:[],tags:[],form:{tag:null,order:"num",page:1,pagesize:15,total:0},orders:{collect:"\u6536\u85CF\u6392\u5E8F",rate:"\u8BC4\u5206\u6392\u5E8F",years:"\u65F6\u95F4\u6392\u5E8F",num:"\u70ED\u5EA6\u6392\u5E8F"}}},async created(){await this.get_tags(),this.form.tag=this.$route.query.tag,this.form.tag&&(this.form.tag=Number(this.form.tag)),await this.search()},computed:{title(){return[(this.tags.find(t=>t.id===this.form.tag)||{}).name,this.orders[this.form.order]].filter(t=>t).join(" - ")}},methods:{toDetail(r){this.$router.push({name:"Detail",params:{id:r}})},handleCurrentChange(r){this.form.page=r,this.search()},changeOrder(){this.form.page=1,this.search()},async search(){let{data:{Data:{total:r,results:t}}}=await y.post("movies/",this.form);this.movies=t,this.form.total=r},async get_tags(){let{data:{Data:r}}=await y.get("all_tags/");this.tags=r}}},B={class:"card-header"},N={class:"movies"},P={style:{"text-align":"center","font-size":"12px"}},q={style:{display:"flex","justify-content":"center","margin-top":"30px"}};function O(r,t,F,U,a,i){const h=n("el-option"),f=n("el-select"),x=n("el-button"),v=n("el-card"),b=n("el-pagination"),V=n("Page"),k=w("src");return s(),c(V,null,{default:o(()=>[u(v,null,{header:o(()=>[l("div",B,[l("span",null,m(i.title),1),l("div",null,[u(f,{clearable:"",filterable:"",class:"button",type:"primary",size:"large",onChange:i.changeOrder,modelValue:a.form.tag,"onUpdate:modelValue":t[0]||(t[0]=e=>a.form.tag=e),placeholder:"\u7535\u5F71\u6807\u7B7E"},{default:o(()=>[(s(!0),g(_,null,p(a.tags,e=>(s(),c(h,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"]),u(f,{style:{"margin-left":"10px"},class:"button",type:"primary",size:"large",onChange:i.changeOrder,modelValue:a.form.order,"onUpdate:modelValue":t[1]||(t[1]=e=>a.form.order=e)},{default:o(()=>[(s(!0),g(_,null,p(a.orders,(e,d)=>(s(),c(h,{key:d,label:e,value:d},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"])])])]),default:o(()=>[l("div",N,[(s(!0),g(_,null,p(a.movies,e=>(s(),c(v,{class:"movie",shadow:"hover",key:e.id,onClick:d=>i.toDetail(e.id),style:{cursor:"pointer"}},{default:o(()=>[z(l("img",null,null,512),[[k,e.image_link]]),u(x,{type:"text"},{default:o(()=>[j(m(e.name),1)]),_:2},1024),l("span",P,m(e.years),1)]),_:2},1032,["onClick"]))),128))]),l("div",q,[u(b,{onCurrentChange:i.handleCurrentChange,"current-page":a.form.page,"page-size":a.form.pagesize,layout:"prev, pager, next, jumper, total",total:a.form.total,background:""},null,8,["onCurrentChange","current-page","page-size","total"])])]),_:1})]),_:1})}C.render=O;C.__scopeId="data-v-3177109a";export{C as default};
